import{r as i,s as f,j as e,C as A,B as a,M as E,h as v}from"./index-UXjltUhQ.js";const R=()=>{const[D,O]=i.useState([]),[l,d]=i.useState(null),[B,g]=i.useState(!0),[j,_]=i.useState(null),[n,x]=i.useState({name:"",description:""}),[M,b]=i.useState(!1),[y,w]=i.useState(""),[z,u]=i.useState(!1),[N,p]=i.useState(null),[s,o]=i.useState({question_text:"",option_a:"",option_b:"",option_c:"",option_d:"",correct_answer:"A",difficulty:"easy",is_active:1}),[S,k]=i.useState(!1),[C,h]=i.useState(""),[Q,m]=i.useState("");i.useEffect(()=>{r()},[]);const r=async()=>{g(!0),w("");try{const t=await f.getAllSkillsWithQuestions();O(t.data.data),t.data.data.length>0?d(t.data.data[0]):d(null)}catch{w("Failed to load skills")}finally{g(!1)}},F=t=>{_(t),x({name:t.name,description:t.description}),b(!0)},H=async()=>{j&&(await f.updateSkill(j.id,n),b(!1),_(null),r())},I=async t=>{window.confirm("Delete this skill and all its questions?")&&(await f.deleteSkill(t),d(null),r())},$=t=>{p(t),o({question_text:t.question_text,option_a:t.option_a,option_b:t.option_b,option_c:t.option_c,option_d:t.option_d,correct_answer:t.correct_answer,difficulty:t.difficulty||"easy",is_active:t.is_active}),k(!1),u(!0)},L=()=>{p(null),o({question_text:"",option_a:"",option_b:"",option_c:"",option_d:"",correct_answer:"A",difficulty:"easy",is_active:1}),k(!0),u(!0)},P=async()=>{if(m(""),!!l){if(!s.question_text.trim()||!s.option_a.trim()||!s.option_b.trim()||!s.option_c.trim()||!s.option_d.trim()){m("All fields are required.");return}try{S?(await v.addQuestion({skill_id:l.id,...s}),h("Question added successfully.")):N&&(await v.updateQuestion(N.id,s),h("Question updated successfully.")),u(!1),p(null),o({question_text:"",option_a:"",option_b:"",option_c:"",option_d:"",correct_answer:"A",difficulty:"easy",is_active:1}),r()}catch{m("Failed to save question.")}}},T=async t=>{t&&window.confirm("Delete this question?")&&(await v.deleteQuestion(t),r())};return e.jsxs("div",{className:"flex flex-col md:flex-row gap-8 py-8 px-4 max-w-7xl mx-auto",style:{height:"80vh"},children:[e.jsxs("div",{className:"md:w-1/3 w-full overflow-y-auto pr-2 custom-scrollbar",style:{maxHeight:"100%"},children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:"Skills"}),B?e.jsx("div",{className:"flex justify-center",children:e.jsx("span",{children:"Loading..."})}):y?e.jsx("div",{className:"text-red-500",children:y}):e.jsx("div",{className:"space-y-3",children:D.map(t=>e.jsx(A,{className:`p-4 cursor-pointer border-2 transition-all duration-200 ${l&&l.id===t.id?"border-blue-500 bg-blue-50":"border-transparent hover:border-blue-300"}`,onClick:()=>d(t),children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-lg text-blue-900",children:t.name}),e.jsx("div",{className:"text-xs text-gray-500",children:t.description})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(a,{size:"sm",variant:"secondary",onClick:c=>{c.stopPropagation(),F(t)},children:"Edit"}),e.jsx(a,{size:"sm",variant:"danger",onClick:c=>{c.stopPropagation(),I(t.id)},children:"Delete"})]})]})},t.id))})]}),e.jsxs("div",{className:"md:w-2/3 w-full overflow-y-auto pl-2 custom-scrollbar",style:{maxHeight:"100%"},children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Questions"}),l&&e.jsx(a,{size:"sm",variant:"primary",onClick:L,children:"Add Question"})]}),l&&l.questions&&l.questions.length>0?e.jsx("div",{className:"space-y-3",children:l.questions.map((t,c)=>e.jsxs(A,{className:`p-4 flex flex-col md:flex-row md:items-center md:justify-between border shadow-sm ${t.isSeedOnly?"bg-yellow-50 border-yellow-300":"bg-white border-gray-200"}`,children:[e.jsxs("div",{children:[e.jsxs("div",{className:"font-medium text-gray-900 mb-1",children:[t.question_text,t.isSeedOnly&&e.jsx("span",{className:"ml-2 px-2 py-0.5 rounded text-xs font-semibold bg-yellow-200 text-yellow-800 border border-yellow-400 align-middle",children:"Seed Only"})]}),e.jsxs("div",{className:"text-xs text-gray-500 mb-1",children:["A: ",t.option_a," | B: ",t.option_b," | C: ",t.option_c," | D:"," ",t.option_d]}),e.jsxs("div",{className:"text-xs text-gray-400",children:["Correct: ",t.correct_answer," | Difficulty: ",t.difficulty," | Active: ",t.is_active?"Yes":"No"]})]}),e.jsxs("div",{className:"flex gap-2 mt-2 md:mt-0",children:[e.jsx(a,{size:"sm",variant:"secondary",onClick:()=>$(t),disabled:t.isSeedOnly,title:t.isSeedOnly?"Import to DB before editing":"Edit question",children:"Edit"}),e.jsx(a,{size:"sm",variant:"danger",onClick:()=>T(t.id),disabled:t.isSeedOnly,title:t.isSeedOnly?"Import to DB before deleting":void 0,children:"Delete"})]})]},t.id?t.id:`seed-${c}`))}):null]}),e.jsxs(E,{isOpen:M,onClose:()=>b(!1),title:"Edit Skill",children:[e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Skill Name"}),e.jsx("input",{className:"border border-[var(--border-color)] bg-[rgba(var(--modal-bg-rgb,255,255,255),0.5)] backdrop-blur text-[var(--text-primary)] p-2 mb-2 w-full rounded-lg shadow-inner focus:ring-2 focus:ring-accent focus:border-accent theme-transition",value:n.name,onChange:t=>x({...n,name:t.target.value}),placeholder:"Skill Name",autoComplete:"off"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Description"}),e.jsx("textarea",{className:"border border-[var(--border-color)] bg-[rgba(var(--modal-bg-rgb,255,255,255),0.5)] backdrop-blur text-[var(--text-primary)] p-2 mb-2 w-full rounded-lg shadow-inner focus:ring-2 focus:ring-accent focus:border-accent theme-transition",value:n.description,onChange:t=>x({...n,description:t.target.value}),placeholder:"Description",autoComplete:"off"})]}),e.jsx(a,{onClick:H,variant:"primary",children:"Save"})]}),e.jsxs(E,{isOpen:z,onClose:()=>{u(!1),m("")},title:S?"Add Question":"Edit Question",children:[e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Question Text"}),e.jsx("textarea",{className:"border border-[var(--border-color)] bg-[rgba(var(--modal-bg-rgb,255,255,255),0.5)] backdrop-blur text-[var(--text-primary)] p-2 mb-2 w-full rounded-lg shadow-inner focus:ring-2 focus:ring-accent focus:border-accent theme-transition",value:s.question_text,onChange:t=>o({...s,question_text:t.target.value}),placeholder:"Question Text",autoComplete:"off"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 mb-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium mb-1",children:"Option A"}),e.jsx("input",{className:"border p-2 w-full rounded",value:s.option_a,onChange:t=>o({...s,option_a:t.target.value}),placeholder:"Option A"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium mb-1",children:"Option B"}),e.jsx("input",{className:"border p-2 w-full rounded",value:s.option_b,onChange:t=>o({...s,option_b:t.target.value}),placeholder:"Option B"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium mb-1",children:"Option C"}),e.jsx("input",{className:"border p-2 w-full rounded",value:s.option_c,onChange:t=>o({...s,option_c:t.target.value}),placeholder:"Option C"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium mb-1",children:"Option D"}),e.jsx("input",{className:"border p-2 w-full rounded",value:s.option_d,onChange:t=>o({...s,option_d:t.target.value}),placeholder:"Option D"})]})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"block text-xs font-medium mb-1",children:"Correct Answer"}),e.jsxs("select",{className:"border-2 border-[var(--accent-color)] bg-[rgba(139,92,246,0.10)] text-[var(--accent-color)] font-semibold p-3 w-full rounded-xl shadow-[0_2px_12px_rgba(139,92,246,0.10)] focus:ring-2 focus:ring-[var(--accent-color)] focus:border-[var(--accent-color)] theme-transition outline-none",value:s.correct_answer,onChange:t=>o({...s,correct_answer:t.target.value}),children:[e.jsx("option",{value:"A",children:"A"}),e.jsx("option",{value:"B",children:"B"}),e.jsx("option",{value:"C",children:"C"}),e.jsx("option",{value:"D",children:"D"})]})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"block text-xs font-medium mb-1",children:"Difficulty"}),e.jsxs("select",{className:"border-2 border-[var(--accent-color)] bg-[rgba(139,92,246,0.10)] text-[var(--accent-color)] font-semibold p-3 w-full rounded-xl shadow-[0_2px_12px_rgba(139,92,246,0.10)] focus:ring-2 focus:ring-[var(--accent-color)] focus:border-[var(--accent-color)] theme-transition outline-none",value:s.difficulty,onChange:t=>o({...s,difficulty:t.target.value}),children:[e.jsx("option",{value:"easy",children:"Easy"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"hard",children:"Hard"})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-xs font-medium mb-1",children:"Active"}),e.jsxs("select",{className:"border-2 border-[var(--accent-color)] bg-[rgba(139,92,246,0.10)] text-[var(--accent-color)] font-semibold p-3 w-full rounded-xl shadow-[0_2px_12px_rgba(139,92,246,0.10)] focus:ring-2 focus:ring-[var(--accent-color)] focus:border-[var(--accent-color)] theme-transition outline-none",value:s.is_active,onChange:t=>o({...s,is_active:Number(t.target.value)}),children:[e.jsx("option",{value:1,children:"Yes"}),e.jsx("option",{value:0,children:"No"})]})]}),Q&&e.jsx("div",{className:"text-red-500 text-sm mb-2",children:Q}),e.jsx(a,{onClick:P,variant:"primary",disabled:!s.question_text.trim()||!s.option_a.trim()||!s.option_b.trim()||!s.option_c.trim()||!s.option_d.trim(),children:"Save"})]}),C&&e.jsxs("div",{className:"fixed bottom-4 right-4 bg-green-600 text-white px-4 py-2 rounded shadow-lg z-50",children:[C,e.jsx("button",{className:"ml-2 text-white font-bold",onClick:()=>h(""),children:"Ã—"})]})]})};export{R as default};
