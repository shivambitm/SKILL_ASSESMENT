import{c as C,u as G,a as I,r,b as m,d as j,j as e,U as H,A as J,L as Z,C as c,R as q,e as ee,f as se,X as ae,Y as re,T as le,g as te,B as h,M as w}from"./index-DwHOoaIw.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ce=C("BarChart2",[["line",{x1:"18",x2:"18",y1:"20",y2:"10",key:"1xfpm4"}],["line",{x1:"12",x2:"12",y1:"20",y2:"4",key:"be30l9"}],["line",{x1:"6",x2:"6",y1:"20",y2:"14",key:"1r4le6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ie=C("CheckCircle2",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),ne=()=>{const{user:p}=G(),y=I(),[b,u]=r.useState("skills"),[l,z]=r.useState(null),[A,T]=r.useState([]),[i,R]=r.useState(null),[Q,L]=r.useState([]),[o,D]=r.useState([]),[v,P]=r.useState([]),[g,F]=r.useState([]),[B,E]=r.useState(!1),[U,N]=r.useState(!1),[M,n]=r.useState(!1),[f,d]=r.useState("");r.useEffect(()=>{if(!p||p.role!=="admin"){y("/admin/dashboard");return}_()},[p,y]);const _=async()=>{var s,a;n(!0),d("");try{const[t,x,V,W,X,Y]=await Promise.all([m.getSummary(),j.get("/admin/users"),j.get("/admin/skills"),m.getRecentQuizzes(),m.getSkillPerformance(),m.getPerformanceTrend()]);z(t.data),T(V.data.data.skills||[]),D(W.data.recent||[]),P(X.data.skills||[]),F(Y.data.trend||[])}catch(t){d(((a=(s=t==null?void 0:t.response)==null?void 0:s.data)==null?void 0:a.message)||"Failed to load dashboard data")}finally{n(!1)}},O=async s=>{var a,t;n(!0),d("");try{const x=await j.get(`/admin/skills/${s}/questions`);L(x.data.data.questions)}catch(x){d(((t=(a=x.response)==null?void 0:a.data)==null?void 0:t.message)||"Failed to fetch questions")}finally{n(!1)}},$=s=>{R(s),O(s.id),u("questions")};let k="—",S="";if(o.length>0){let s=-1;o.forEach(a=>{a.percentage>s&&(s=a.percentage,k=a.percentage?a.percentage.toFixed(2)+"%":"—",S=a.username||"")})}const K=[{icon:e.jsx(H,{className:"w-6 h-6"}),label:"Total Users",value:(l==null?void 0:l.totalUsers)??"—",color:"bg-gradient-to-r from-indigo-500 to-blue-600"},{icon:e.jsx(ce,{className:"w-6 h-6"}),label:"Total Quizzes",value:(l==null?void 0:l.totalQuizzes)??"—",color:"bg-gradient-to-r from-pink-500 to-purple-600"},{icon:e.jsx(J,{className:"w-6 h-6"}),label:"Best Score",value:k,sub:S,color:"bg-gradient-to-r from-yellow-400 to-orange-500"},{icon:e.jsx(ie,{className:"w-6 h-6"}),label:"Accuracy Rate",value:(l==null?void 0:l.avgScore)!==void 0?`${l.avgScore}%`:"—",color:"bg-gradient-to-r from-green-400 to-emerald-600"}];return e.jsxs("div",{className:"min-h-[calc(100vh-64px)] py-8 px-4 sm:px-6 lg:px-8",style:{backgroundColor:"var(--bg-primary)",color:"var(--text-primary)"},children:[e.jsx("div",{className:"flex items-center justify-between mb-6",children:e.jsx("h1",{className:"text-2xl font-bold",style:{color:"var(--text-primary)"},children:"Welcome, Admin!"})}),M?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx(Z,{})}):f?e.jsx("div",{className:"mb-4 p-4 bg-red-900 text-red-100 rounded-lg",children:f}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:K.map((s,a)=>e.jsx(c,{className:"theme-transition rounded-lg shadow-md overflow-hidden",style:{background:"linear-gradient(to right, #3b82f6, #2563eb)",color:"#fff"},children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-3 rounded-lg",style:{backgroundColor:"rgba(255,255,255,0.2)"},children:s.icon}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium opacity-90",children:s.label}),e.jsx("p",{className:"text-2xl font-bold",children:s.value}),s.sub&&e.jsx("p",{className:"text-xs opacity-80",children:s.sub})]})]})},a))}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[e.jsxs(c,{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",style:{color:"var(--text-primary)"},children:"Scores vs Time"}),e.jsx("div",{className:"mb-4 max-h-80 min-h-[200px]",children:e.jsx(q,{width:"100%",height:400,children:e.jsxs(ee,{data:g.map(s=>({name:s.username,score:typeof s.score=="number"?s.score:Number(s.score),time:s.created_at})),children:[e.jsx(se,{strokeDasharray:"3 3",stroke:"var(--border-color)"}),e.jsx(ae,{dataKey:"time",stroke:"var(--text-secondary)",tickFormatter:s=>new Date(s).toLocaleDateString(),label:{value:"Time",position:"insideBottom",offset:-5,fill:"var(--text-secondary)"}}),e.jsx(re,{stroke:"var(--text-secondary)",label:{value:"Score",angle:-90,position:"insideLeft",fill:"var(--text-secondary)"}}),e.jsx(le,{contentStyle:{backgroundColor:"var(--bg-primary)",color:"var(--text-primary)",borderColor:"var(--border-color)"},labelFormatter:s=>new Date(s).toLocaleString()}),e.jsx(te,{type:"monotone",dataKey:"score",stroke:"#34d399",strokeWidth:3,dot:{r:4},name:"Score"})]})})})]}),e.jsxs(c,{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",style:{color:"var(--text-primary)"},children:"Skill Performance"}),e.jsx("div",{className:"max-h-96 overflow-y-auto pr-2 scrollbar-thin scrollbar-thumb-[var(--accent-color)] scrollbar-track-[var(--bg-tertiary)]",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{style:{color:"var(--text-secondary)"},children:[e.jsx("th",{className:"px-2 py-1 text-left",children:"Skill"}),e.jsx("th",{className:"px-2 py-1 text-right",children:"Times Taken"})]})}),e.jsx("tbody",{children:v.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:2,className:"text-center py-4",style:{color:"var(--text-secondary)"},children:"No skill data"})}):v.map(s=>e.jsxs("tr",{className:"hover:bg-gray-700 transition",children:[e.jsx("td",{className:"px-2 py-1",children:s.name}),e.jsx("td",{className:"px-2 py-1 text-right",children:s.times_taken})]},s.id))})]})})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[e.jsxs(c,{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",style:{color:"var(--text-primary)"},children:"Recent Quizzes"}),e.jsx("div",{className:"max-h-96 overflow-y-auto pr-2 scrollbar-thin scrollbar-thumb-[var(--accent-color)] scrollbar-track-[var(--bg-tertiary)]",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{style:{color:"var(--text-secondary)"},children:[e.jsx("th",{className:"px-2 py-1",children:"Username"}),e.jsx("th",{className:"px-2 py-1",children:"Skill"}),e.jsx("th",{className:"px-2 py-1",children:"Score %"}),e.jsx("th",{className:"px-2 py-1",children:"Time"})]})}),e.jsx("tbody",{children:o.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"text-center py-4",style:{color:"var(--text-secondary)"},children:"No recent quizzes"})}):o.map(s=>e.jsxs("tr",{className:"hover:bg-gray-700 transition",children:[e.jsx("td",{className:"px-2 py-1",children:s.username}),e.jsx("td",{className:"px-2 py-1",children:s.skill_name}),e.jsx("td",{className:"px-2 py-1",children:s.percentage?s.percentage.toFixed(2):"—"}),e.jsx("td",{className:"px-2 py-1",children:new Date(s.created_at).toLocaleString()})]},s.id))})]})})})]}),e.jsxs(c,{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",style:{color:"var(--text-primary)"},children:"Performance Trend (Recent)"}),e.jsx("div",{className:"max-h-500 min-h-[120px] overflow-y-scroll pr-2 scrollbar-thin scrollbar-thumb-[var(--accent-color)] scrollbar-track-[var(--bg-tertiary)]",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{style:{color:"var(--text-secondary)"},children:[e.jsx("th",{className:"px-2 py-1",children:"Username"}),e.jsx("th",{className:"px-2 py-1",children:"Score"}),e.jsx("th",{className:"px-2 py-1",children:"Time"})]})}),e.jsx("tbody",{children:g.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:3,className:"text-center py-4",style:{color:"var(--text-secondary)"},children:"No trend data"})}):g.map((s,a)=>e.jsxs("tr",{className:"hover:bg-gray-700 transition",children:[e.jsx("td",{className:"px-2 py-1",children:s.username}),e.jsx("td",{className:"px-2 py-1",children:s.score}),e.jsx("td",{className:"px-2 py-1",children:new Date(s.created_at).toLocaleString()})]},a))})]})})})]})]}),b==="skills"&&e.jsx("div",{className:"space-y-4",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:A.map(s=>e.jsx(c,{className:"cursor-pointer",onClick:()=>$(s),children:e.jsxs("div",{className:"p-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:s.name}),e.jsx("p",{className:"text-gray-400",children:s.description}),e.jsxs("div",{className:"mt-2 text-sm text-gray-500",children:["Category: ",s.category]})]})},s.id))})}),b==="questions"&&i&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-bold",style:{color:"var(--text-primary)"},children:[i.name," - Questions"]}),e.jsx("p",{className:"text-gray-400",children:i.description})]}),e.jsxs("div",{className:"space-x-2",children:[e.jsx(h,{onClick:()=>u("skills"),children:"Back to Skills"}),e.jsx(h,{onClick:()=>N(!0),children:"Add Question"})]})]}),e.jsx("div",{className:"space-y-4 custom-scrollbar max-h-[400px] overflow-y-auto",children:Q.map(s=>e.jsxs(c,{children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold",children:s.questionText}),e.jsxs("div",{className:"space-x-2",children:[e.jsx(h,{variant:"secondary",onClick:()=>{},children:"Edit"}),e.jsx(h,{variant:"danger",onClick:()=>{},children:"Delete"})]})]}),e.jsx("div",{className:"mt-2 grid grid-cols-2 gap-2",children:Object.entries(s.options).map(([a,t])=>e.jsxs("div",{className:`p-2 rounded ${s.correctAnswer===a?"bg-green-100 border border-green-300":"bg-gray-50"}`,children:[a,": ",t]},a))}),e.jsxs("div",{className:"mt-2 text-sm text-gray-500",children:["Difficulty: ",s.difficulty," | Points:"," ",s.points]})]},s.id))})]})]}),e.jsx(w,{isOpen:B,onClose:()=>E(!1),title:i?"Edit Skill":"Add New Skill"}),e.jsx(w,{isOpen:U,onClose:()=>N(!1),title:"Add New Question"}),e.jsx("style",{children:`
        .custom-scrollbar {
          scrollbar-width: thin;
          scrollbar-color: #6366f1 #18181b;
        }
        .custom-scrollbar::-webkit-scrollbar {
          width: 8px;
          background: #18181b;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb {
          background: #6366f1;
          border-radius: 8px;
        }
        .custom-scrollbar::-webkit-scrollbar-track {
          background: #18181b;
        }
      `})]})};export{ne as default};
